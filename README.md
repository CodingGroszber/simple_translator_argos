# Argos Translate Utility

This is a Python-based translation utility using the [Argos Translate](https://github.com/argosopentech/argos-translate) library. It allows downloading, installing, and using translation models for offline text translation between languages. The project is managed with [Poetry](https://python-poetry.org/) for dependency management.

Models are downloaded as `.argosmodel` files to a custom `./assets/packages` directory and installed (unzipped) to `./assets/models`. This overrides the library's default installation path for portability.

## Features

- Install translation models on-demand for specific language pairs (e.g., English to German).
- Translate text using installed models.
- Reset functionality to uninstall all models and wipe data.
- Command-line interface with configurable source/target languages and text.
- Custom asset directories for models and packages under `./assets`.
- Logging for info and debug modes.

## Project Structure

```
.
├── pyproject.toml          # Poetry configuration and dependencies
├── poetry.lock             # Locked dependencies (generated by Poetry)
├── assets/                 # Custom directory for all assets
│   ├── packages/           # Downloaded .argosmodel files
│   └── models/             # Installed (unzipped) model files
├── src/                    # Source code (assuming the script is placed here; adjust if different)
│   └── translator.py       # Main script (the provided code)
└── README.md               # This file
```

- **assets/packages**: Stores raw downloaded model files (e.g., `en_de.argosmodel`).
- **assets/models**: Stores the unzipped/installed models used by Argos Translate.
- The script calculates paths relative to its location using `Path(__file__).resolve().parent.parent.parent` as the base directory.

## Requirements

- Python 3.8+ (tested with 3.12 via the code interpreter tool).
- Dependencies (managed via Poetry):
  - `argostranslate`: For translation functionality.
  - Other standard libraries: `pathlib`, `os`, `shutil`, `argparse`, `logging`, `traceback`, `sys`.

## Installation

1. Install Poetry if not already installed:
   ```
   pip install poetry
   ```

2. Clone or set up the project directory with the provided code in `src/translator.py` (or your preferred file name).

3. Install dependencies:
   ```
   poetry install
   ```

   This will create a virtual environment and install `argostranslate` and other requirements.

## Usage

Run the script using Poetry to ensure the virtual environment is activated:

```
poetry run python src/translator.py [options]
```

### Command-Line Arguments

- `--reset`: Force reset all installed models and data (uninstalls models and removes the models directory).
- `--from-lang <code>`: Source language code (default: `en` for English).
- `--to-lang <code>`: Target language code (default: `de` for German).
- `--text <string>`: Text to translate (default: "Hello, world! This is a test translation.").
- `--debug`: Enable debug logging for detailed error traces.

### Examples

1. **Basic Translation**:
   ```
   poetry run python src/translator.py --from-lang en --to-lang fr --text "Hello, how are you?"
   ```
   - Downloads and installs the English-to-French model if needed.
   - Outputs the translated text.

2. **Reset Models**:
   ```
   poetry run python src/translator.py --reset
   ```
   - Uninstalls all models and wipes the `./assets/models` directory.

3. **Debug Mode**:
   ```
   poetry run python src/translator.py --debug --from-lang en --to-lang es --text "Test with debug."
   ```
   - Runs with verbose logging.

### How It Works

- **Model Management**:
  - Models are downloaded to `./assets/packages` if not present.
  - Installed to `./assets/models` via `package.install_from_path()`.
  - The environment variable `ARGOS_PACKAGES_DIR` is set before importing `argostranslate` to override the default installation path (`~/.local/share/argos-translate/packages`).

- **Translation Process**:
  - Checks if the model is installed.
  - If not, updates the package index, downloads the model, and installs it.
  - Creates a translator object and performs the translation.

- **Reset**:
  - Uninstalls packages using `package.uninstall_package()`.
  - Removes the entire `./assets/models` directory.

## Notes

- Language codes follow ISO 639-1 (e.g., `en` for English, `de` for German). Check Argos Translate documentation for supported pairs.
- The script ensures directories are created if they don't exist.
- If issues arise with paths, verify the script's location relative to the base directory.
- No internet is required after models are installed, but initial downloads need connectivity.
- For custom paths, the code uses relative paths; adjust `BASE_DIR` if needed.

## Troubleshooting

- **Model Not Installing to Custom Path**: Ensure `os.environ["ARGOS_PACKAGES_DIR"]` is set before importing `argostranslate`. If using an older version, try `ARGOS_TRANSLATE_PACKAGES_DIR`.
- **Permission Issues**: Run with appropriate permissions if directories can't be created.
- **Unsupported Language Pair**: The script raises a `ValueError` if no model is available.
- **Debugging**: Use `--debug` to see stack traces on errors.

For more on Argos Translate, visit the [official repository](https://github.com/argosopentech/argos-translate).